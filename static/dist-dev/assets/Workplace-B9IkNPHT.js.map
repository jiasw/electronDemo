{"version":3,"file":"Workplace-B9IkNPHT.js","sources":["../../src/hooks/web/useTimeAgo.ts","../../src/api/dashboard/workplace/index.ts","../../src/views/Dashboard/Workplace.vue"],"sourcesContent":["import { useTimeAgo as useTimeAgoCore, UseTimeAgoMessages } from '@vueuse/core'\nimport { computed, unref } from 'vue'\nimport { useLocaleStoreWithOut } from '@/store/modules/locale'\n\nconst TIME_AGO_MESSAGE_MAP: {\n  'zh-CN': UseTimeAgoMessages\n  en: UseTimeAgoMessages\n} = {\n  'zh-CN': {\n    justNow: '刚刚',\n    invalid: '无效时间',\n    past: (n) => (n.match(/\\d/) ? `${n}前` : n),\n    future: (n) => (n.match(/\\d/) ? `${n}后` : n),\n    month: (n, past) => (n === 1 ? (past ? '上个月' : '下个月') : `${n} 个月`),\n    year: (n, past) => (n === 1 ? (past ? '去年' : '明年') : `${n} 年`),\n    day: (n, past) => (n === 1 ? (past ? '昨天' : '明天') : `${n} 天`),\n    week: (n, past) => (n === 1 ? (past ? '上周' : '下周') : `${n} 周`),\n    hour: (n) => `${n} 小时`,\n    minute: (n) => `${n} 分钟`,\n    second: (n) => `${n} 秒`\n  },\n  en: {\n    justNow: '刚刚',\n    invalid: 'Invalid Date',\n    past: (n) => (n.match(/\\d/) ? `${n} ago` : n),\n    future: (n) => (n.match(/\\d/) ? `in ${n}` : n),\n    month: (n, past) =>\n      n === 1 ? (past ? 'last month' : 'next month') : `${n} month${n > 1 ? 's' : ''}`,\n    year: (n, past) =>\n      n === 1 ? (past ? 'last year' : 'next year') : `${n} year${n > 1 ? 's' : ''}`,\n    day: (n, past) => (n === 1 ? (past ? 'yesterday' : 'tomorrow') : `${n} day${n > 1 ? 's' : ''}`),\n    week: (n, past) =>\n      n === 1 ? (past ? 'last week' : 'next week') : `${n} week${n > 1 ? 's' : ''}`,\n    hour: (n) => `${n} hour${n > 1 ? 's' : ''}`,\n    minute: (n) => `${n} minute${n > 1 ? 's' : ''}`,\n    second: (n) => `${n} second${n > 1 ? 's' : ''}`\n  }\n}\n\nexport const useTimeAgo = (time: Date | number | string) => {\n  const localeStore = useLocaleStoreWithOut()\n\n  const currentLocale = computed(() => localeStore.getCurrentLocale)\n\n  const timeAgo = useTimeAgoCore(time, {\n    messages: TIME_AGO_MESSAGE_MAP[unref(currentLocale).lang]\n  })\n\n  return timeAgo\n}\n","import request from '@/axios'\nimport type { WorkplaceTotal, Project, Dynamic, Team, RadarData } from './types'\n\nexport const getCountApi = (): Promise<IResponse<WorkplaceTotal>> => {\n  return request.get({ url: '/mock/workplace/total' })\n}\n\nexport const getProjectApi = (): Promise<IResponse<Project>> => {\n  return request.get({ url: '/mock/workplace/project' })\n}\n\nexport const getDynamicApi = (): Promise<IResponse<Dynamic[]>> => {\n  return request.get({ url: '/mock/workplace/dynamic' })\n}\n\nexport const getTeamApi = (): Promise<IResponse<Team[]>> => {\n  return request.get({ url: '/mock/workplace/team' })\n}\n\nexport const getRadarApi = (): Promise<IResponse<RadarData[]>> => {\n  return request.get({ url: '/mock/workplace/radar' })\n}\n","<script setup lang=\"ts\">\nimport { useTimeAgo } from '@/hooks/web/useTimeAgo'\nimport { ElRow, ElCol, ElSkeleton, ElCard, ElDivider, ElLink } from 'element-plus'\nimport { useI18n } from '@/hooks/web/useI18n'\nimport { ref, reactive } from 'vue'\nimport { CountTo } from '@/components/CountTo'\nimport { formatTime } from '@/utils'\nimport { Echart } from '@/components/Echart'\nimport { EChartsOption } from 'echarts'\nimport { radarOption } from './echarts-data'\nimport { Highlight } from '@/components/Highlight'\nimport {\n  getCountApi,\n  getProjectApi,\n  getDynamicApi,\n  getTeamApi,\n  getRadarApi\n} from '@/api/dashboard/workplace'\nimport type { WorkplaceTotal, Project, Dynamic, Team } from '@/api/dashboard/workplace/types'\nimport { set } from 'lodash-es'\n\nconst loading = ref(true)\n\n// 获取统计数\nlet totalSate = reactive<WorkplaceTotal>({\n  project: 0,\n  access: 0,\n  todo: 0\n})\n\nconst getCount = async () => {\n  const res = await getCountApi().catch(() => {})\n  if (res) {\n    totalSate = Object.assign(totalSate, res.data)\n  }\n}\n\nlet projects = reactive<Project[]>([])\n\n// 获取项目数\nconst getProject = async () => {\n  const res = await getProjectApi().catch(() => {})\n  if (res) {\n    projects = Object.assign(projects, res.data)\n  }\n}\n\n// 获取动态\nlet dynamics = reactive<Dynamic[]>([])\n\nconst getDynamic = async () => {\n  const res = await getDynamicApi().catch(() => {})\n  if (res) {\n    dynamics = Object.assign(dynamics, res.data)\n  }\n}\n\n// 获取团队\nlet team = reactive<Team[]>([])\n\nconst getTeam = async () => {\n  const res = await getTeamApi().catch(() => {})\n  if (res) {\n    team = Object.assign(team, res.data)\n  }\n}\n\n// 获取指数\nconst radarOptionData = reactive<EChartsOption>(radarOption) as EChartsOption\n\nconst getRadar = async () => {\n  const res = await getRadarApi().catch(() => {})\n  if (res) {\n    set(\n      radarOptionData,\n      'radar.indicator',\n      res.data.map((v) => {\n        return {\n          name: t(v.name),\n          max: v.max\n        }\n      })\n    )\n    set(radarOptionData, 'series', [\n      {\n        name: `xxx${t('workplace.index')}`,\n        type: 'radar',\n        data: [\n          {\n            value: res.data.map((v) => v.personal),\n            name: t('workplace.personal')\n          },\n          {\n            value: res.data.map((v) => v.team),\n            name: t('workplace.team')\n          }\n        ]\n      }\n    ])\n  }\n}\n\nconst getAllApi = async () => {\n  await Promise.all([getCount(), getProject(), getDynamic(), getTeam(), getRadar()])\n  loading.value = false\n}\n\ngetAllApi()\n\nconst { t } = useI18n()\n</script>\n\n<template>\n  <div>\n    <ElCard shadow=\"never\">\n      <ElSkeleton :loading=\"loading\" animated>\n        <ElRow :gutter=\"20\" justify=\"space-between\">\n          <ElCol :xl=\"12\" :lg=\"12\" :md=\"12\" :sm=\"24\" :xs=\"24\">\n            <div class=\"flex items-center\">\n              <img\n                src=\"@/assets/imgs/avatar.jpg\"\n                alt=\"\"\n                class=\"w-70px h-70px rounded-[50%] mr-20px\"\n              />\n              <div>\n                <div class=\"text-20px\">\n                  {{ t('workplace.goodMorning') }}，Archer，{{ t('workplace.happyDay') }}\n                </div>\n                <div class=\"mt-10px text-14px text-gray-500\">\n                  {{ t('workplace.toady') }}，20℃ - 32℃！\n                </div>\n              </div>\n            </div>\n          </ElCol>\n          <ElCol :xl=\"12\" :lg=\"12\" :md=\"12\" :sm=\"24\" :xs=\"24\">\n            <div class=\"flex h-70px items-center justify-end lt-sm:mt-20px\">\n              <div class=\"px-8px text-right\">\n                <div class=\"text-14px text-gray-400 mb-20px\">{{ t('workplace.project') }}</div>\n                <CountTo\n                  class=\"text-20px\"\n                  :start-val=\"0\"\n                  :end-val=\"totalSate.project\"\n                  :duration=\"2600\"\n                />\n              </div>\n              <ElDivider direction=\"vertical\" />\n              <div class=\"px-8px text-right\">\n                <div class=\"text-14px text-gray-400 mb-20px\">{{ t('workplace.toDo') }}</div>\n                <CountTo\n                  class=\"text-20px\"\n                  :start-val=\"0\"\n                  :end-val=\"totalSate.todo\"\n                  :duration=\"2600\"\n                />\n              </div>\n              <ElDivider direction=\"vertical\" border-style=\"dashed\" />\n              <div class=\"px-8px text-right\">\n                <div class=\"text-14px text-gray-400 mb-20px\">{{ t('workplace.access') }}</div>\n                <CountTo\n                  class=\"text-20px\"\n                  :start-val=\"0\"\n                  :end-val=\"totalSate.access\"\n                  :duration=\"2600\"\n                />\n              </div>\n            </div>\n          </ElCol>\n        </ElRow>\n      </ElSkeleton>\n    </ElCard>\n  </div>\n\n  <ElRow class=\"mt-20px\" :gutter=\"20\" justify=\"space-between\">\n    <ElCol :xl=\"16\" :lg=\"16\" :md=\"24\" :sm=\"24\" :xs=\"24\" class=\"mb-20px\">\n      <ElCard shadow=\"never\">\n        <template #header>\n          <div class=\"flex justify-between\">\n            <span>{{ t('workplace.project') }}</span>\n            <ElLink type=\"primary\" :underline=\"false\">{{ t('workplace.more') }}</ElLink>\n          </div>\n        </template>\n        <ElSkeleton :loading=\"loading\" animated>\n          <ElRow>\n            <ElCol\n              v-for=\"(item, index) in projects\"\n              :key=\"`card-${index}`\"\n              :xl=\"8\"\n              :lg=\"8\"\n              :md=\"12\"\n              :sm=\"24\"\n              :xs=\"24\"\n            >\n              <ElCard shadow=\"hover\">\n                <div class=\"flex items-center\">\n                  <Icon :icon=\"item.icon\" :size=\"25\" class=\"mr-10px\" />\n                  <span class=\"text-16px\">{{ item.name }}</span>\n                </div>\n                <div class=\"mt-15px text-14px text-gray-400\">{{ t(item.message) }}</div>\n                <div class=\"mt-20px text-12px text-gray-400 flex justify-between\">\n                  <span>{{ item.personal }}</span>\n                  <span>{{ formatTime(item.time, 'yyyy-MM-dd') }}</span>\n                </div>\n              </ElCard>\n            </ElCol>\n          </ElRow>\n        </ElSkeleton>\n      </ElCard>\n\n      <ElCard shadow=\"never\" class=\"mt-20px\">\n        <template #header>\n          <div class=\"flex justify-between\">\n            <span>{{ t('workplace.dynamic') }}</span>\n            <ElLink type=\"primary\" :underline=\"false\">{{ t('workplace.more') }}</ElLink>\n          </div>\n        </template>\n        <ElSkeleton :loading=\"loading\" animated>\n          <div v-for=\"(item, index) in dynamics\" :key=\"`dynamics-${index}`\">\n            <div class=\"flex items-center\">\n              <img\n                src=\"@/assets/imgs/avatar.jpg\"\n                alt=\"\"\n                class=\"w-35px h-35px rounded-[50%] mr-20px\"\n              />\n              <div>\n                <div class=\"text-14px\">\n                  <Highlight :keys=\"item.keys.map((v) => t(v))\">\n                    {{ t('workplace.pushCode') }}\n                  </Highlight>\n                </div>\n                <div class=\"mt-15px text-12px text-gray-400\">\n                  {{ useTimeAgo(item.time) }}\n                </div>\n              </div>\n            </div>\n            <ElDivider />\n          </div>\n        </ElSkeleton>\n      </ElCard>\n    </ElCol>\n    <ElCol :xl=\"8\" :lg=\"8\" :md=\"24\" :sm=\"24\" :xs=\"24\" class=\"mb-20px\">\n      <ElCard shadow=\"never\">\n        <template #header>\n          <span>{{ t('workplace.shortcutOperation') }}</span>\n        </template>\n        <ElSkeleton :loading=\"loading\" animated>\n          <ElRow>\n            <ElCol\n              v-for=\"item in 9\"\n              :key=\"`card-${item}`\"\n              :xl=\"12\"\n              :lg=\"12\"\n              :md=\"12\"\n              :sm=\"24\"\n              :xs=\"24\"\n              class=\"mb-10px\"\n            >\n              <ElLink type=\"default\" :underline=\"false\">\n                {{ t('workplace.operation') }}{{ item }}\n              </ElLink>\n            </ElCol>\n          </ElRow>\n        </ElSkeleton>\n      </ElCard>\n\n      <ElCard shadow=\"never\" class=\"mt-20px\">\n        <template #header>\n          <span>xx{{ t('workplace.index') }}</span>\n        </template>\n        <ElSkeleton :loading=\"loading\" animated>\n          <Echart :options=\"radarOptionData\" :height=\"400\" />\n        </ElSkeleton>\n      </ElCard>\n\n      <ElCard shadow=\"never\" class=\"mt-20px\">\n        <template #header>\n          <span>{{ t('workplace.team') }}</span>\n        </template>\n        <ElSkeleton :loading=\"loading\" animated>\n          <ElRow>\n            <ElCol v-for=\"item in team\" :key=\"`team-${item.name}`\" :span=\"12\" class=\"mb-20px\">\n              <div class=\"flex items-center\">\n                <Icon :icon=\"item.icon\" class=\"mr-10px\" />\n                <ElLink type=\"default\" :underline=\"false\">\n                  {{ item.name }}\n                </ElLink>\n              </div>\n            </ElCol>\n          </ElRow>\n        </ElSkeleton>\n      </ElCard>\n    </ElCol>\n  </ElRow>\n</template>\n"],"names":["TIME_AGO_MESSAGE_MAP","n","past","useTimeAgo","time","localeStore","useLocaleStoreWithOut","currentLocale","computed","useTimeAgoCore","unref","getCountApi","request","getProjectApi","getDynamicApi","getTeamApi","getRadarApi","loading","ref","totalSate","reactive","getCount","__async","res","projects","getProject","dynamics","getDynamic","team","getTeam","radarOptionData","radarOption","getRadar","set","v","t","useI18n"],"mappings":"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"}