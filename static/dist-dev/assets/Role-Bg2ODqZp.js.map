{"version":3,"file":"Role-Bg2ODqZp.js","sources":["../../src/views/Authorization/Role/Role.vue"],"sourcesContent":["<script setup lang=\"tsx\">\nimport { reactive, ref, unref } from 'vue'\nimport { getRoleListApi } from '@/api/role'\nimport { useTable } from '@/hooks/web/useTable'\nimport { useI18n } from '@/hooks/web/useI18n'\nimport { Table, TableColumn } from '@/components/Table'\nimport { ElTag } from 'element-plus'\nimport { Search } from '@/components/Search'\nimport { FormSchema } from '@/components/Form'\nimport { ContentWrap } from '@/components/ContentWrap'\nimport Write from './components/Write.vue'\nimport Detail from './components/Detail.vue'\nimport { Dialog } from '@/components/Dialog'\nimport { BaseButton } from '@/components/Button'\n\nconst { t } = useI18n()\n\nconst { tableRegister, tableState, tableMethods } = useTable({\n  fetchDataApi: async () => {\n    const res = await getRoleListApi()\n    return {\n      list: res.data.list || [],\n      total: res.data.total\n    }\n  }\n})\n\nconst { dataList, loading, total } = tableState\nconst { getList } = tableMethods\n\nconst tableColumns = reactive<TableColumn[]>([\n  {\n    field: 'index',\n    label: t('userDemo.index'),\n    type: 'index'\n  },\n  {\n    field: 'roleName',\n    label: t('role.roleName')\n  },\n  {\n    field: 'status',\n    label: t('menu.status'),\n    slots: {\n      default: (data: any) => {\n        return (\n          <>\n            <ElTag type={data.row.status === 0 ? 'danger' : 'success'}>\n              {data.row.status === 1 ? t('userDemo.enable') : t('userDemo.disable')}\n            </ElTag>\n          </>\n        )\n      }\n    }\n  },\n  {\n    field: 'createTime',\n    label: t('tableDemo.displayTime')\n  },\n  {\n    field: 'remark',\n    label: t('userDemo.remark')\n  },\n  {\n    field: 'action',\n    label: t('userDemo.action'),\n    width: 240,\n    slots: {\n      default: (data: any) => {\n        const row = data.row\n        return (\n          <>\n            <BaseButton type=\"primary\" onClick={() => action(row, 'edit')}>\n              {t('exampleDemo.edit')}\n            </BaseButton>\n            <BaseButton type=\"success\" onClick={() => action(row, 'detail')}>\n              {t('exampleDemo.detail')}\n            </BaseButton>\n            <BaseButton type=\"danger\">{t('exampleDemo.del')}</BaseButton>\n          </>\n        )\n      }\n    }\n  }\n])\n\nconst searchSchema = reactive<FormSchema[]>([\n  {\n    field: 'roleName',\n    label: t('role.roleName'),\n    component: 'Input'\n  }\n])\n\nconst searchParams = ref({})\nconst setSearchParams = (data: any) => {\n  searchParams.value = data\n  getList()\n}\n\nconst dialogVisible = ref(false)\nconst dialogTitle = ref('')\n\nconst currentRow = ref()\nconst actionType = ref('')\n\nconst writeRef = ref<ComponentRef<typeof Write>>()\n\nconst saveLoading = ref(false)\n\nconst action = (row: any, type: string) => {\n  dialogTitle.value = t(type === 'edit' ? 'exampleDemo.edit' : 'exampleDemo.detail')\n  actionType.value = type\n  currentRow.value = row\n  dialogVisible.value = true\n}\n\nconst AddAction = () => {\n  dialogTitle.value = t('exampleDemo.add')\n  currentRow.value = undefined\n  dialogVisible.value = true\n  actionType.value = ''\n}\n\nconst save = async () => {\n  const write = unref(writeRef)\n  const formData = await write?.submit()\n  if (formData) {\n    saveLoading.value = true\n    setTimeout(() => {\n      saveLoading.value = false\n      dialogVisible.value = false\n    }, 1000)\n  }\n}\n</script>\n\n<template>\n  <ContentWrap>\n    <Search :schema=\"searchSchema\" @reset=\"setSearchParams\" @search=\"setSearchParams\" />\n    <div class=\"mb-10px\">\n      <BaseButton type=\"primary\" @click=\"AddAction\">{{ t('exampleDemo.add') }}</BaseButton>\n    </div>\n    <Table\n      :columns=\"tableColumns\"\n      default-expand-all\n      node-key=\"id\"\n      :data=\"dataList\"\n      :loading=\"loading\"\n      :pagination=\"{\n        total\n      }\"\n      @register=\"tableRegister\"\n    />\n  </ContentWrap>\n\n  <Dialog v-model=\"dialogVisible\" :title=\"dialogTitle\">\n    <Write v-if=\"actionType !== 'detail'\" ref=\"writeRef\" :current-row=\"currentRow\" />\n    <Detail v-else :current-row=\"currentRow\" />\n\n    <template #footer>\n      <BaseButton\n        v-if=\"actionType !== 'detail'\"\n        type=\"primary\"\n        :loading=\"saveLoading\"\n        @click=\"save\"\n      >\n        {{ t('exampleDemo.save') }}\n      </BaseButton>\n      <BaseButton @click=\"dialogVisible = false\">{{ t('dialogDemo.close') }}</BaseButton>\n    </template>\n  </Dialog>\n</template>\n"],"names":["_isSlot","s","Object","prototype","toString","call","_isVNode","t","useI18n","tableRegister","tableState","tableMethods","useTable","fetchDataApi","__async","res","getRoleListApi","list","data","total","dataList","loading","getList","tableColumns","reactive","field","label","type","slots","default","_createVNode2","_Fragment2","ElTag","row","status","width","_slot","_slot2","_slot3","BaseButton","onClick","action","searchSchema","component","searchParams","ref","setSearchParams","value","dialogVisible","dialogTitle","currentRow","actionType","writeRef","saveLoading","AddAction","undefined","save","write","unref","submit","setTimeout"],"mappings":"wqEAa+C,SAAAA,EAAAC,EAAA,CAAA,OAAA,OAAAA,GAAA,YAAAC,OAAAC,UAAAC,SAAAC,KAAAJ,CAAA,IAAAK,mBAAAA,CAAAA,GAAAL,CAAA,CAAA,oCAE/C,KAAM,CAAEM,EAAAA,CAAG,EAAGC,EAAQ,EAEhB,CAAEC,cAAAA,EAAeC,WAAAA,EAAYC,aAAAA,CAAc,EAAGC,EAAS,CAC3DC,aAAc,IAAYC,EAAA,sBACxB,MAAMC,EAAM,MAAMC,EAAe,EACjC,MAAO,CACLC,KAAMF,EAAIG,KAAKD,MAAQ,CAAE,EACzBE,MAAOJ,EAAIG,KAAKC,KAClB,CACF,EACF,CAAC,EAEK,CAAEC,SAAAA,EAAUC,QAAAA,EAASF,MAAAA,CAAM,EAAIT,EAC/B,CAAEY,QAAAA,CAAQ,EAAIX,EAEdY,EAAeC,EAAwB,CAC3C,CACEC,MAAO,QACPC,MAAOnB,EAAE,gBAAgB,EACzBoB,KAAM,OACR,EACA,CACEF,MAAO,WACPC,MAAOnB,EAAE,eAAe,CAC1B,EACA,CACEkB,MAAO,SACPC,MAAOnB,EAAE,aAAa,EACtBqB,MAAO,CACLC,QAAUX,GACRY,EAAAC,EAAAD,KAAAA,CAAAA,EAAAE,EAAA,CAAA,KAEiBd,EAAKe,IAAIC,SAAW,EAAI,SAAW,SAAS,EAAA,CAAAL,QAAAA,IAAA,CACtDX,EAAKe,IAAIC,SAAW,EAAI3B,EAAE,iBAAiB,EAAIA,EAAE,kBAAkB,CAAC,CAAA,CAAA,CAAA,CAAA,CAK/E,CACF,EACA,CACEkB,MAAO,aACPC,MAAOnB,EAAE,uBAAuB,CAClC,EACA,CACEkB,MAAO,SACPC,MAAOnB,EAAE,iBAAiB,CAC5B,EACA,CACEkB,MAAO,SACPC,MAAOnB,EAAE,iBAAiB,EAC1B4B,MAAO,IACPP,MAAO,CACLC,QAAUX,GAAc,CAAA,IAAAkB,EAAAC,EAAAC,EACtB,MAAML,EAAMf,EAAKe,IACjB,OAAAH,EAAAC,EAAAD,KAAAA,CAAAA,EAAAS,EAAA,CAAA,KAAA,UAAA,QAEwCC,IAAMC,EAAOR,EAAK,MAAM,GAACjC,EAAAoC,EAC1D7B,EAAE,kBAAkB,CAAC,EAAA6B,EAAA,CAAAP,QAAAA,IAAA,CAAAO,CAAA,EAAAN,EAAAA,EAAAS,EAAA,CAAA,KAAA,UAAA,QAEYC,IAAMC,EAAOR,EAAK,QAAQ,GAACjC,EAAAqC,EAC5D9B,EAAE,oBAAoB,CAAC,EAAA8B,EAAA,CAAAR,QAAAA,IAAA,CAAAQ,CAAA,EAAAP,EAAAA,EAAAS,EAAA,CAAA,KAAA,UAAAvC,EAAAsC,EAEC/B,EAAE,iBAAiB,CAAC,EAAA+B,EAAA,CAAAT,QAAAA,IAAA,CAAAS,CAAA,CAAA,CAAA,CAAA,CAAA,CAGrD,CACF,CACF,CAAA,CACD,EAEKI,EAAelB,EAAuB,CAC1C,CACEC,MAAO,WACPC,MAAOnB,EAAE,eAAe,EACxBoC,UAAW,OACb,CAAA,CACD,EAEKC,EAAeC,EAAI,EAAE,EACrBC,EAAmB5B,GAAc,CACrC0B,EAAaG,MAAQ7B,EACrBI,EAAQ,CACV,EAEM0B,EAAgBH,EAAI,EAAK,EACzBI,EAAcJ,EAAI,EAAE,EAEpBK,EAAaL,EAAI,EACjBM,EAAaN,EAAI,EAAE,EAEnBO,EAAWP,EAAgC,EAE3CQ,EAAcR,EAAI,EAAK,EAEvBJ,EAASA,CAACR,EAAUN,IAAiB,CACzCsB,EAAYF,MAAQxC,EAAEoB,IAAS,OAAS,mBAAqB,oBAAoB,EACjFwB,EAAWJ,MAAQpB,EACnBuB,EAAWH,MAAQd,EACnBe,EAAcD,MAAQ,EACxB,EAEMO,EAAYA,IAAM,CACtBL,EAAYF,MAAQxC,EAAE,iBAAiB,EACvC2C,EAAWH,MAAQQ,OACnBP,EAAcD,MAAQ,GACtBI,EAAWJ,MAAQ,EACrB,EAEMS,EAAO,IAAY1C,EAAA,sBACvB,MAAM2C,EAAQC,EAAMN,CAAQ,GACX,MAAMK,GAAAA,YAAAA,EAAOE,YAE5BN,EAAYN,MAAQ,GACpBa,WAAW,IAAM,CACfP,EAAYN,MAAQ,GACpBC,EAAcD,MAAQ,EACvB,EAAE,GAAI,EAEX"}