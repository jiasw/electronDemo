{"version":3,"file":"RegisterForm.vue_vue_type_script_setup_true_lang-BqBaVbjY.js","sources":["../../src/views/Login/components/RegisterForm.vue"],"sourcesContent":["<script setup lang=\"tsx\">\nimport { Form, FormSchema } from '@/components/Form'\nimport { reactive, ref, unref } from 'vue'\nimport { useI18n } from '@/hooks/web/useI18n'\nimport { useForm } from '@/hooks/web/useForm'\nimport { ElInput, FormRules } from 'element-plus'\nimport { useValidator } from '@/hooks/web/useValidator'\nimport { BaseButton } from '@/components/Button'\nimport { IAgree } from '@/components/IAgree'\n\nconst emit = defineEmits(['to-login'])\n\nconst { formRegister, formMethods } = useForm()\nconst { getElFormExpose } = formMethods\n\nconst { t } = useI18n()\n\nconst { required, check } = useValidator()\n\nconst getCodeTime = ref(60)\nconst getCodeLoading = ref(false)\nconst getCode = () => {\n  getCodeLoading.value = true\n  const timer = setInterval(() => {\n    getCodeTime.value--\n    if (getCodeTime.value <= 0) {\n      clearInterval(timer)\n      getCodeTime.value = 60\n      getCodeLoading.value = false\n    }\n  }, 1000)\n}\n\nconst schema = reactive<FormSchema[]>([\n  {\n    field: 'title',\n    colProps: {\n      span: 24\n    },\n    formItemProps: {\n      slots: {\n        default: () => {\n          return <h2 class=\"text-2xl font-bold text-center w-[100%]\">{t('login.register')}</h2>\n        }\n      }\n    }\n  },\n  {\n    field: 'username',\n    label: t('login.username'),\n    value: '',\n    component: 'Input',\n    colProps: {\n      span: 24\n    },\n    componentProps: {\n      placeholder: t('login.usernamePlaceholder')\n    }\n  },\n  {\n    field: 'password',\n    label: t('login.password'),\n    value: '',\n    component: 'InputPassword',\n    colProps: {\n      span: 24\n    },\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      strength: true,\n      placeholder: t('login.passwordPlaceholder')\n    }\n  },\n  {\n    field: 'check_password',\n    label: t('login.checkPassword'),\n    value: '',\n    component: 'InputPassword',\n    colProps: {\n      span: 24\n    },\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      strength: true,\n      placeholder: t('login.passwordPlaceholder')\n    }\n  },\n  {\n    field: 'code',\n    label: t('login.code'),\n    colProps: {\n      span: 24\n    },\n    formItemProps: {\n      slots: {\n        default: (formData) => {\n          return (\n            <div class=\"w-[100%] flex\">\n              <ElInput v-model={formData.code} placeholder={t('login.codePlaceholder')} />\n              <BaseButton\n                type=\"primary\"\n                disabled={unref(getCodeLoading)}\n                class=\"ml-10px\"\n                onClick={getCode}\n              >\n                {t('login.getCode')}\n                {unref(getCodeLoading) ? `(${unref(getCodeTime)})` : ''}\n              </BaseButton>\n            </div>\n          )\n        }\n      }\n    }\n  },\n\n  {\n    field: 'iAgree',\n    colProps: {\n      span: 24\n    },\n    formItemProps: {\n      slots: {\n        default: (formData: any) => {\n          return (\n            <>\n              <IAgree\n                v-model={formData.iAgree}\n                text=\"我同意《用户协议》\"\n                link={[\n                  {\n                    text: '《用户协议》',\n                    url: 'https://element-plus.org/'\n                  }\n                ]}\n              />\n            </>\n          )\n        }\n      }\n    }\n  },\n  {\n    field: 'register',\n    colProps: {\n      span: 24\n    },\n    formItemProps: {\n      slots: {\n        default: () => {\n          return (\n            <>\n              <div class=\"w-[100%]\">\n                <BaseButton\n                  type=\"primary\"\n                  class=\"w-[100%]\"\n                  loading={loading.value}\n                  onClick={loginRegister}\n                >\n                  {t('login.register')}\n                </BaseButton>\n              </div>\n              <div class=\"w-[100%] mt-15px\">\n                <BaseButton class=\"w-[100%]\" onClick={toLogin}>\n                  {t('login.hasUser')}\n                </BaseButton>\n              </div>\n            </>\n          )\n        }\n      }\n    }\n  }\n])\n\nconst rules: FormRules = {\n  username: [required()],\n  password: [required()],\n  check_password: [required()],\n  code: [required()],\n  iAgree: [required(), check()]\n}\n\nconst toLogin = () => {\n  emit('to-login')\n}\n\nconst loading = ref(false)\n\nconst loginRegister = async () => {\n  const formRef = await getElFormExpose()\n  formRef?.validate(async (valid) => {\n    if (valid) {\n      try {\n        loading.value = true\n        toLogin()\n      } finally {\n        loading.value = false\n      }\n    }\n  })\n}\n</script>\n\n<template>\n  <Form\n    :schema=\"schema\"\n    :rules=\"rules\"\n    label-position=\"top\"\n    hide-required-asterisk\n    size=\"large\"\n    class=\"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid\"\n    @register=\"formRegister\"\n  />\n</template>\n"],"names":["_isSlot","s","Object","prototype","toString","call","_isVNode","emit","__emit","formRegister","formMethods","useForm","getElFormExpose","t","useI18n","required","check","useValidator","getCodeTime","ref","getCodeLoading","getCode","value","timer","setInterval","clearInterval","schema","reactive","field","colProps","span","formItemProps","slots","default","_createVNode","label","component","componentProps","placeholder","style","width","strength","formData","ElInput","code","$event","BaseButton","unref","_Fragment","IAgree","iAgree","text","url","_slot","_slot2","loading","loginRegister","toLogin","rules","username","password","check_password","__async","formRef","validate","valid"],"mappings":"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"}