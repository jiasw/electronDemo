{"version":3,"file":"Write.vue_vue_type_script_setup_true_lang-TUKDzr2n.js","sources":["../../src/views/Example/Page/components/Write.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { Form, FormSchema } from '@/components/Form'\nimport { useForm } from '@/hooks/web/useForm'\nimport { PropType, reactive, watch } from 'vue'\nimport { TableData } from '@/api/table/types'\nimport { useI18n } from '@/hooks/web/useI18n'\nimport { useValidator } from '@/hooks/web/useValidator'\nimport { IDomEditor } from '@wangeditor/editor'\n\nconst { required } = useValidator()\n\nconst props = defineProps({\n  currentRow: {\n    type: Object as PropType<Nullable<TableData>>,\n    default: () => null\n  }\n})\n\nconst { t } = useI18n()\n\nconst { formRegister, formMethods } = useForm()\nconst { setValues, getFormData, getElFormExpose, setSchema } = formMethods\n\nconst schema = reactive<FormSchema[]>([\n  {\n    field: 'title',\n    label: t('exampleDemo.title'),\n    component: 'Input',\n    formItemProps: {\n      rules: [required()]\n    },\n    colProps: {\n      span: 24\n    }\n  },\n  {\n    field: 'author',\n    label: t('exampleDemo.author'),\n    component: 'Input',\n    formItemProps: {\n      rules: [required()]\n    }\n  },\n  {\n    field: 'display_time',\n    label: t('exampleDemo.displayTime'),\n    component: 'DatePicker',\n    componentProps: {\n      type: 'datetime',\n      valueFormat: 'YYYY-MM-DD HH:mm:ss'\n    },\n    formItemProps: {\n      rules: [required()]\n    }\n  },\n  {\n    field: 'importance',\n    label: t('exampleDemo.importance'),\n    component: 'Select',\n    formItemProps: {\n      rules: [required()]\n    },\n    componentProps: {\n      options: [\n        {\n          label: '重要',\n          value: 3\n        },\n        {\n          label: '良好',\n          value: 2\n        },\n        {\n          label: '一般',\n          value: 1\n        }\n      ]\n    }\n  },\n  {\n    field: 'pageviews',\n    label: t('exampleDemo.pageviews'),\n    component: 'InputNumber',\n    value: 0,\n    formItemProps: {\n      rules: [required()]\n    }\n  },\n  {\n    field: 'content',\n    component: 'Editor',\n    colProps: {\n      span: 24\n    },\n    componentProps: {\n      defaultHtml: '',\n      // @ts-ignore\n      onChange: (edit: IDomEditor) => {\n        setValues({\n          content: edit.getHtml()\n        })\n      }\n    },\n    label: t('exampleDemo.content')\n  }\n])\n\nconst rules = reactive({\n  title: [required()],\n  author: [required()],\n  importance: [required()],\n  pageviews: [required()],\n  display_time: [required()],\n  content: [required()]\n})\n\nconst submit = async () => {\n  const elForm = await getElFormExpose()\n  const valid = await elForm?.validate().catch((err) => {\n    console.log(err)\n  })\n  if (valid) {\n    const formData = await getFormData()\n    return formData\n  }\n}\n\nwatch(\n  () => props.currentRow,\n  (currentRow) => {\n    if (!currentRow) return\n    setValues(currentRow)\n    setSchema([\n      {\n        field: 'content',\n        path: 'componentProps.defaultHtml',\n        value: currentRow.content\n      }\n    ])\n  },\n  {\n    deep: true,\n    immediate: true\n  }\n)\n\ndefineExpose({\n  submit\n})\n</script>\n\n<template>\n  <Form :rules=\"rules\" @register=\"formRegister\" :schema=\"schema\" />\n</template>\n"],"names":["required","useValidator","props","__props","t","useI18n","formRegister","formMethods","useForm","setValues","getFormData","getElFormExpose","setSchema","schema","reactive","edit","rules","submit","__async","elForm","err","watch","currentRow","__expose"],"mappings":"qiBASM,KAAA,CAAE,SAAAA,CAAS,EAAIC,EAAa,EAE5BC,EAAQC,EAOR,CAAE,EAAAC,CAAE,EAAIC,EAAQ,EAEhB,CAAE,aAAAC,EAAc,YAAAC,CAAY,EAAIC,EAAQ,EACxC,CAAE,UAAAC,EAAW,YAAAC,EAAa,gBAAAC,EAAiB,UAAAC,CAAc,EAAAL,EAEzDM,EAASC,EAAuB,CACpC,CACE,MAAO,QACP,MAAOV,EAAE,mBAAmB,EAC5B,UAAW,QACX,cAAe,CACb,MAAO,CAACJ,EAAU,CAAA,CACpB,EACA,SAAU,CACR,KAAM,EAAA,CAEV,EACA,CACE,MAAO,SACP,MAAOI,EAAE,oBAAoB,EAC7B,UAAW,QACX,cAAe,CACb,MAAO,CAACJ,EAAU,CAAA,CAAA,CAEtB,EACA,CACE,MAAO,eACP,MAAOI,EAAE,yBAAyB,EAClC,UAAW,aACX,eAAgB,CACd,KAAM,WACN,YAAa,qBACf,EACA,cAAe,CACb,MAAO,CAACJ,EAAU,CAAA,CAAA,CAEtB,EACA,CACE,MAAO,aACP,MAAOI,EAAE,wBAAwB,EACjC,UAAW,SACX,cAAe,CACb,MAAO,CAACJ,EAAU,CAAA,CACpB,EACA,eAAgB,CACd,QAAS,CACP,CACE,MAAO,KACP,MAAO,CACT,EACA,CACE,MAAO,KACP,MAAO,CACT,EACA,CACE,MAAO,KACP,MAAO,CAAA,CACT,CACF,CAEJ,EACA,CACE,MAAO,YACP,MAAOI,EAAE,uBAAuB,EAChC,UAAW,cACX,MAAO,EACP,cAAe,CACb,MAAO,CAACJ,EAAU,CAAA,CAAA,CAEtB,EACA,CACE,MAAO,UACP,UAAW,SACX,SAAU,CACR,KAAM,EACR,EACA,eAAgB,CACd,YAAa,GAEb,SAAWe,GAAqB,CACpBN,EAAA,CACR,QAASM,EAAK,QAAQ,CAAA,CACvB,CAAA,CAEL,EACA,MAAOX,EAAE,qBAAqB,CAAA,CAChC,CACD,EAEKY,EAAQF,EAAS,CACrB,MAAO,CAACd,GAAU,EAClB,OAAQ,CAACA,GAAU,EACnB,WAAY,CAACA,GAAU,EACvB,UAAW,CAACA,GAAU,EACtB,aAAc,CAACA,GAAU,EACzB,QAAS,CAACA,EAAU,CAAA,CAAA,CACrB,EAEKiB,EAAS,IAAYC,EAAA,sBACnB,MAAAC,EAAS,MAAMR,EAAgB,EAIrC,GAHc,MAAMQ,GAAA,YAAAA,EAAQ,WAAW,MAAOC,GAAQ,CACpD,QAAQ,IAAIA,CAAG,CAAA,GAIR,OADU,MAAMV,EAAY,CAGvC,GAEA,OAAAW,EACE,IAAMnB,EAAM,WACXoB,GAAe,CACTA,IACLb,EAAUa,CAAU,EACVV,EAAA,CACR,CACE,MAAO,UACP,KAAM,6BACN,MAAOU,EAAW,OAAA,CACpB,CACD,EACH,EACA,CACE,KAAM,GACN,UAAW,EAAA,CAEf,EAEaC,EAAA,CACX,OAAAN,CAAA,CACD"}