{"version":3,"file":"useWatermark-C_1StZo4.js","sources":["../../src/hooks/web/useWatermark.ts","../../src/views/hooks/useWatermark.vue"],"sourcesContent":["const domSymbol = Symbol('watermark-dom')\n\nexport function useWatermark(appendEl: HTMLElement | null = document.body) {\n  let func: Fn = () => {}\n  const id = domSymbol.toString()\n  const clear = () => {\n    const domId = document.getElementById(id)\n    if (domId) {\n      const el = appendEl\n      el && el.removeChild(domId)\n    }\n    window.removeEventListener('resize', func)\n  }\n  const createWatermark = (str: string) => {\n    clear()\n\n    const can = document.createElement('canvas')\n    can.width = 300\n    can.height = 240\n\n    const cans = can.getContext('2d')\n    if (cans) {\n      cans.rotate((-20 * Math.PI) / 120)\n      cans.font = '15px Vedana'\n      cans.fillStyle = 'rgba(0, 0, 0, 0.15)'\n      cans.textAlign = 'left'\n      cans.textBaseline = 'middle'\n      cans.fillText(str, can.width / 20, can.height)\n    }\n\n    const div = document.createElement('div')\n    div.id = id\n    div.style.pointerEvents = 'none'\n    div.style.top = '0px'\n    div.style.left = '0px'\n    div.style.position = 'absolute'\n    div.style.zIndex = '100000000'\n    div.style.width = document.documentElement.clientWidth + 'px'\n    div.style.height = document.documentElement.clientHeight + 'px'\n    div.style.background = 'url(' + can.toDataURL('image/png') + ') left top repeat'\n    const el = appendEl\n    el && el.appendChild(div)\n    return id\n  }\n\n  function setWatermark(str: string) {\n    createWatermark(str)\n    func = () => {\n      createWatermark(str)\n    }\n    window.addEventListener('resize', func)\n  }\n\n  return { setWatermark, clear }\n}\n","<script setup lang=\"ts\">\nimport { ContentWrap } from '@/components/ContentWrap'\nimport { useI18n } from '@/hooks/web/useI18n'\nimport { useWatermark } from '@/hooks/web/useWatermark'\nimport { computed, onBeforeUnmount } from 'vue'\nimport { useAppStore } from '@/store/modules/app'\n\nconst appStore = useAppStore()\n\nconst title = computed(() => appStore.getTitle)\n\nconst { setWatermark, clear } = useWatermark()\n\nconst { t } = useI18n()\n\nonBeforeUnmount(() => {\n  clear()\n})\n</script>\n\n<template>\n  <ContentWrap title=\"useWatermark\">\n    <BaseButton type=\"primary\" @click=\"setWatermark(title)\">\n      {{ t('watermarkDemo.createdWatermark') }}\n    </BaseButton>\n    <BaseButton type=\"danger\" @click=\"clear\">{{ t('watermarkDemo.clearWatermark') }}</BaseButton>\n    <BaseButton type=\"warning\" @click=\"setWatermark(`New${title}`)\">\n      {{ t('watermarkDemo.resetWatermark') }}\n    </BaseButton>\n  </ContentWrap>\n</template>\n"],"names":["domSymbol","useWatermark","appendEl","func","id","clear","domId","el","createWatermark","str","can","cans","div","setWatermark","appStore","useAppStore","title","computed","t","useI18n","onBeforeUnmount"],"mappings":"kVAAA,MAAMA,EAAY,OAAO,eAAe,EAExB,SAAAC,EAAaC,EAA+B,SAAS,KAAM,CACzE,IAAIC,EAAW,IAAM,CAAC,EAChB,MAAAC,EAAKJ,EAAU,SAAS,EACxBK,EAAQ,IAAM,CACZ,MAAAC,EAAQ,SAAS,eAAeF,CAAE,EACxC,GAAIE,EAAO,CACT,MAAMC,EAAKL,EACLK,GAAAA,EAAG,YAAYD,CAAK,CAAA,CAErB,OAAA,oBAAoB,SAAUH,CAAI,CAC3C,EACMK,EAAmBC,GAAgB,CACjCJ,EAAA,EAEA,MAAAK,EAAM,SAAS,cAAc,QAAQ,EAC3CA,EAAI,MAAQ,IACZA,EAAI,OAAS,IAEP,MAAAC,EAAOD,EAAI,WAAW,IAAI,EAC5BC,IACFA,EAAK,OAAQ,IAAM,KAAK,GAAM,GAAG,EACjCA,EAAK,KAAO,cACZA,EAAK,UAAY,sBACjBA,EAAK,UAAY,OACjBA,EAAK,aAAe,SACpBA,EAAK,SAASF,EAAKC,EAAI,MAAQ,GAAIA,EAAI,MAAM,GAGzC,MAAAE,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,GAAKR,EACTQ,EAAI,MAAM,cAAgB,OAC1BA,EAAI,MAAM,IAAM,MAChBA,EAAI,MAAM,KAAO,MACjBA,EAAI,MAAM,SAAW,WACrBA,EAAI,MAAM,OAAS,YACnBA,EAAI,MAAM,MAAQ,SAAS,gBAAgB,YAAc,KACzDA,EAAI,MAAM,OAAS,SAAS,gBAAgB,aAAe,KAC3DA,EAAI,MAAM,WAAa,OAASF,EAAI,UAAU,WAAW,EAAI,oBAC7D,MAAMH,EAAKL,EACL,OAAAK,GAAAA,EAAG,YAAYK,CAAG,EACjBR,CACT,EAEA,SAASS,EAAaJ,EAAa,CACjCD,EAAgBC,CAAG,EACnBN,EAAO,IAAM,CACXK,EAAgBC,CAAG,CACrB,EACO,OAAA,iBAAiB,SAAUN,CAAI,CAAA,CAGjC,MAAA,CAAE,aAAAU,EAAc,MAAAR,CAAM,CAC/B,2CC/CA,MAAMS,EAAWC,EAAY,EAEvBC,EAAQC,EAAS,IAAMH,EAAS,QAAQ,EAExC,CAAE,aAAAD,EAAc,MAAAR,CAAM,EAAIJ,EAAa,EAEvC,CAAE,EAAAiB,CAAE,EAAIC,EAAQ,EAEtB,OAAAC,EAAgB,IAAM,CACdf,EAAA,CAAA,CACP"}